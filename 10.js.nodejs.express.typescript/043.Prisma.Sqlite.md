# TS, Prisma, Sqlite

Install:

    yarn add prisma --dev
    yarn add @prisma/client

ä¿®æ”¹ tsconfig.json

    {
      "compilerOptions": {
        "sourceMap": true,
        "outDir": "dist",
        "strict": true,
        "lib": ["esnext"],
        "esModuleInterop": true
      }
    }

åˆå§‹åŒ–æ•°æ®åº“ï¼š

    npx prisma init --datasource-provider sqlite

åˆ›å»ºschemaï¼š

    model memos {
      memo_id     Int       @id @default(autoincrement())
      title       String
      description String?
      status      Int       @default(1)
      created_at  DateTime  @default(now())
      updated_at  DateTime  @default(now())
    }

åœ¨ Sqlite ä¸­ï¼Œä¸»å¼ ä¸ç”¨ autoincrementï¼Œä½†æ˜¯è¿™é‡Œå¿…é¡»å¾—ç”¨ï¼Œæœ‰äººæäº† [issue: (SQLite) Provide control over AUTOINCREMENT modifier in primary keys](https://github.com/prisma/prisma/issues/4721)


## è¿ç§»

å®˜æ–¹å®šä¹‰ï¼š

> "Prisma Migrate is an imperative database schema migration tool that enables you to: Keep your database schema in sync with your Prisma schema as it evolves and maintain existing data in your database." â€“ [Prisma migrate documentation](https://www.prisma.io/docs/concepts/components/prisma-schema/)

åˆ›å»ºæ•°æ®åº“ï¼š

    npx prisma migrate dev --name initialize

## ä½¿ç”¨

è¯¦ç»†ç”¨æ³•çœ‹å®˜æ–¹æ–‡æ¡£ï¼š[CRUD](https://www.prisma.io/docs/concepts/components/prisma-client/crud)

å‚è€ƒæ ¼å¼ï¼š

    import { PrismaClient } from "@prisma/client";

    const prisma = new PrismaClient();
    
    async function main() {}
    
    main()
      .catch((e) => {
        throw e;
      })
      .finally(async () => {
        await prisma.$disconnect();
      });


ä½¿ç”¨ä¾‹å­ï¼š

    import { PrismaClient } from "@prisma/client";
    
    const prisma = new PrismaClient();
    
    async function main() {
      // We create a new user
      const newUser = await prisma.user.create({
        data: {
          email: "hello@herewecode.io",
          username: "gaelgthomas", // <- it's also my Twitter username ğŸ˜„
        },
      });
    
      console.log("New User:");
      console.log(newUser);
    
      // We create a new tweet and we link it to our new user
      const firstTweet = await prisma.tweet.create({
        data: {
          text: "Hello world!",
          userId: newUser.id,
        },
      });
    
      console.log("First tweet:");
      console.log(firstTweet);
    
      // We fetch the new user again (by its unique email address)
      // and we ask to fetch its tweets at the same time
      const newUserWithTweets = await prisma.user.findUnique({
        where: {
          email: "hello@herewecode.io",
        },
        include: { tweets: true },
      });
    
      console.log("User object with Tweets:");
      console.dir(newUserWithTweets);
    }
    
    main()
      .catch((e) => {
        throw e;
      })
      .finally(async () => {
        await prisma.$disconnect();
      });

