# React å°ä¹¦

[React å°ä¹¦](https://hyf.js.org/react-naive-book/lesson4)

æ˜¯ä»€ä¹ˆæ ·çš„é—®é¢˜å¯¼è‡´äº†æˆ‘ä»¬éœ€è¦å‰ç«¯é¡µé¢è¿›è¡Œç»„ä»¶åŒ–ï¼Œå‰ç«¯é¡µé¢çš„ç»„ä»¶åŒ–éœ€è¦è§£å†³ä»€ä¹ˆæ ·çš„é—®é¢˜ã€‚åç»­è¯¾ç¨‹æˆ‘ä»¬å†æ¥çœ‹çœ‹ React.js æ˜¯æ€ä¹ˆè§£å†³è¿™äº›é—®é¢˜çš„ã€‚

## ç¬¬ä¸€ä¸ªä¾‹å­


åœ¨ç»™ LikeButton ç±»æ·»åŠ äº†æ„é€ å‡½æ•°ï¼Œè¿™ä¸ªæ„é€ å‡½æ•°ä¼šç»™æ¯ä¸€ä¸ª LikeButton çš„å®ä¾‹æ·»åŠ ä¸€ä¸ªå¯¹è±¡ stateï¼Œstate é‡Œé¢ä¿å­˜äº†æ¯ä¸ªæŒ‰é’®è‡ªå·±æ˜¯å¦ç‚¹èµçš„çŠ¶æ€ã€‚è¿˜æ”¹å†™äº†åŸæ¥çš„äº‹ä»¶ç»‘å®šå‡½æ•°ï¼šåŸæ¥åªæ‰“å° clickï¼Œç°åœ¨ç‚¹å‡»çš„æŒ‰é’®çš„æ—¶å€™ä¼šè°ƒç”¨ changeLikeText æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šæ ¹æ® this.state çš„çŠ¶æ€æ”¹å˜ç‚¹èµæŒ‰é’®çš„æ–‡æœ¬ã€‚

```html
    <div class='wrapper'>
        <button class='like-btn'>
        </button>
    </div>

    <script>
        const createDOMFromString = (domString) => {
            const div = document.createElement('div')
            div.innerHTML = domString
            return div
        }

        class LikeButton {
            constructor () {
              this.state = { isLiked: false }
            }

            changeLikeText () {
              const likeText = this.el.querySelector('.like-text')
              this.state.isLiked = !this.state.isLiked
              likeText.innerHTML = this.state.isLiked ? 'å–æ¶ˆ' : 'ç‚¹èµ'
            }

            render () {
              this.el = createDOMFromString(`
                <button class='like-button'>
                  <span class='like-text'>ç‚¹èµ</span>
                  <span>ğŸ‘</span>
                </button>
              `)
              this.el.addEventListener('click', this.changeLikeText.bind(this), false)
              return this.el
            }
        }

        // å®ä¾‹åŒ–ä¹‹åæ’å…¥å°±å¯ä»¥ç”¨ã€‚
        const btn = new LikeButton()
        const wrapper = document.querySelector('.wrapper .like-btn')
        wrapper.appendChild(btn.render())
    </script>
```

## å‰ç«¯ç»„ä»¶åŒ–ï¼ˆä¸‰ï¼‰ï¼šæŠ½è±¡å‡ºå…¬å…±ç»„ä»¶ç±»

ç»„ä»¶ç±»ï¼š

```js
  // è¿™ä¸ªæ˜¯ä¸€ä¸ªç»„ä»¶çˆ¶ç±»ï¼Œæ‰€æœ‰çš„ç»„ä»¶éƒ½å¯ä»¥ç»§æ‰¿è¿™ä¸ªçˆ¶ç±»æ¥æ„å»ºã€‚
  class Component {
    setState (state) {
      const oldEl = this.el
      this.state = state
      this.el = this._renderDOM()
      if (this.onStateChange) this.onStateChange(oldEl, this.el)
    }

    // ç§æœ‰æ–¹æ³• _renderDOM ä¼šè°ƒç”¨ this.render æ¥æ„å»º DOM å…ƒç´ å¹¶ä¸”ç›‘å¬ onClick äº‹ä»¶ï¼Œ
    // æ‰€ä»¥ï¼Œç»„ä»¶å­ç±»ç»§æ‰¿çš„æ—¶å€™åªéœ€è¦å®ç°ä¸€ä¸ªè¿”å› HTML å­—ç¬¦ä¸²çš„ render æ–¹æ³•å°±å¯ä»¥äº†ã€‚
    _renderDOM () {
      this.el = createDOMFromString(this.render())
      if (this.onClick) {
        this.el.addEventListener('click', this.onClick.bind(this), false)
      }
      return this.el
    }
  }

  // æŠŠç»„ä»¶çš„ DOM å…ƒç´ æ’å…¥é¡µé¢ï¼Œå¹¶ä¸”åœ¨ setState çš„æ—¶å€™æ›´æ–°é¡µé¢ã€‚
  const mount = (component, wrapper) => {
    wrapper.appendChild(component._renderDOM())
    component.onStateChange = (oldEl, newEl) => {
      wrapper.insertBefore(newEl, oldEl)
      wrapper.removeChild(oldEl)
    }
  }
```


## 6. ä½¿ç”¨ JSX æè¿° UI ä¿¡æ¯

JSX å†™æ³•ï¼š

```js
class Header extends Component {
  render () {
    return (
      <div>
        <h1 className='title'>React å°ä¹¦</h1>
      </div>
    )
  }
}
```

ç»è¿‡ç¼–è¯‘ä¹‹åï¼Œç”Ÿæˆç¬¦åˆ JavaScript è¯­æ³•çš„ç»“æœï¼Œç”¨JSå¯¹è±¡æ¥è¡¨ç¤º HTML ç»“æ„ï¼š

```js
class Header extends Component {
  render () {
    return (
     React.createElement(
        "div",
        null,
        React.createElement(
          "h1",
          { className: 'title' },
          "React å°ä¹¦"
        )
      )
    )
  }
}
```




